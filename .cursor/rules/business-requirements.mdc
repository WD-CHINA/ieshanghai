# 业务需求概要

## 项目背景

**公共文化空间数字化运营平台 - H5 管理端**

为公共文化空间提供移动端管理功能，支持运营管理方和主理人对文化空间的活动排期和场地使用进行管理。

## 用户角色

| 角色           | 权限说明                                             |
| -------------- | ---------------------------------------------------- |
| **运营管理方** | 能够管理文化空间所有场地的活动排期和场地使用申请审核 |
| **主理人**     | 只能处理自己所负责场地的活动排期和场地使用申请       |

## 核心功能模块

### 1. 账户登录

**功能描述**: 提供账户登录功能，支持运营管理方、主理人等用户登录系统

**页面**: 登录页

- 账号输入框 (手机号/用户名)
- 密码输入框
- 图形验证码
- 登录按钮
- 登录成功后跳转至导航页

**相关接口**:

- `H5Api.Account.Login` - 用户登录
- `H5Api.Account.LoginOut` - 用户登出

### 2. 活动排期管理

**功能描述**: 对文化空间场地举办的活动进行排期管理

**子功能**:

1. **活动排期查询**: 查看当前用户所负责场地的活动排期列表
2. **活动排期新增**: 创建新的活动排期
3. **活动排期修改**: 编辑未开始的活动排期
4. **活动预约审核**: 审核居民的活动预约申请
5. **活动实录记录**: 活动完成后记录实际情况

**权限说明**:

- 运营管理方：管理所有场地的活动排期
- 主理人：只能管理自己负责场地的活动排期

#### 2.1 活动排期列表页

**功能点**:

- 展示活动排期列表
- 支持筛选条件：活动名称、时间、场地、是否可预约
- 显示字段：活动名称、时间、场地、状态等
- 操作入口：详情、编辑、预约情况

**活动状态**:

- 1: 待审核
- 2: 待修改
- 3: 按计划
- 4: 已完成
- 5: 已下架
- 6: 已取消
- 7: 已作废

**活动类型** (CanBook):

- 1: 预约活动 (居民可预约)
- 2: 常规活动 (无需预约)
- 4: 团队活动 (团队预约)

**相关接口**:

- `H5Api.Activity.GetActivityList` - 获取活动列表

#### 2.2 活动排期详情页

**功能点**:

- 展示活动详细信息
- 提供操作按钮：返回、编辑、预约详情、活动实录
- 仅可编辑未开始的活动

**显示信息**:

- 基本信息：活动名称、时间、场地、活动介绍
- 图片展示
- 预约信息：预约时间、可预约人数、已预约人数
- 预计参与人次

**相关接口**:

- `H5Api.Activity.GetActivityDetail` - 获取活动详情

#### 2.3 活动排期提交页

**功能点**:

- 新增或编辑活动排期
- 数据校验：时间冲突检测
- 图片上传

**表单字段**:

- **基本信息**:
  - 活动名称 (中文/英文)
  - 服务类型
  - 场地选择
  - 活动时间 (开始时间、结束时间、时长)
  - 预计参与人数
  - 活动介绍 (中文/英文)
  - 活动图片 (列表图、展示图)

- **预约设置** (仅预约活动):
  - 是否可预约
  - 最大可预约数量
  - 单用户可预约数量
  - 预约开始时间
  - 预约结束时间
  - 预约说明

**校验规则**:

- 检查场地时间冲突
- 预约活动必填预约相关字段
- 图片大小和格式限制

**相关接口**:

- `H5Api.Activity.SubmitActivity` - 提交活动排期
- 图片上传接口 (待补充)

#### 2.4 活动预约详情页

**功能点**:

- 展示活动预约列表 (仅可预约活动)
- 审核预约申请 (待审核状态)

**预约状态**:

- 待审核
- 已通过
- 已拒绝
- 已签到
- 未参加

**显示信息**:

- 预约时间
- 联系人
- 联系电话
- 预约人数
- 预约备注
- 预约状态

**操作**:

- 查看预约详情
- 审核 (通过/拒绝) - 仅待审核状态

**业务说明**:

> 社区居民的活动预约申请，在审核通过后，方为有效预约，可以来现场参加活动。

**相关接口**:

- 活动预约列表查询接口 (待补充)
- 活动预约审核接口 (待补充)

#### 2.5 活动实录提交页

**功能点**:

- 记录活动实际完成情况 (活动结束后)
- 上传活动照片和视频

**表单字段**:

- 活动实际参与人次
- 活动情况记录 (文字描述)
- 照片上传 (多张)
- 视频上传

**相关接口**:

- 活动实录提交接口 (待补充)
- 图片上传接口 (待补充)
- 视频上传接口 (待补充)

### 3. 场地使用管理

**功能描述**: 对文化空间各个场地的使用进行登记管理

**子功能**:

1. **场地使用查询**: 查看场地使用申请记录
2. **场地使用申请**: 提交场地使用申请
3. **场地使用修改**: 编辑未开始的场地使用申请
4. **场地使用审核**: 审核其他主理人的场地使用申请

#### 3.1 场地使用列表页

**功能点**:

- 展示场地使用申请记录
- 支持筛选：场地名称、使用日期、使用状态
- 操作入口：详情、编辑、审核

**使用状态**:

- 待审核
- 已通过
- 已拒绝

**显示字段**:

- 场地名称
- 使用时间
- 使用单位
- 用途
- 使用状态

**编辑限制**: 仅可编辑未开始的场地使用申请

**相关接口**:

- 场地使用列表查询接口 (待补充)

#### 3.2 场地使用详情页

**功能点**:

- 展示场地使用申请详细信息

**显示信息**:

- 场地名称
- 使用时间
- 使用单位
- 联系人
- 联系电话
- 用途说明
- 使用状态
- 预计人数
- 备注

**相关接口**:

- 获取场地使用详情接口 (待补充)

#### 3.3 场地使用提交页

**功能点**:

- 新增或编辑场地使用申请
- 数据校验：时间冲突检测

**表单字段**:

- 场地选择
- 使用时间 (开始时间、结束时间)
- 使用单位
- 联系人
- 联系电话
- 用途说明
- 预计人数
- 备注

**校验规则**:

- 检查场地时间冲突
- 必填字段验证
- 联系电话格式验证

**相关接口**:

- 场地使用数据提交接口 (待补充)

#### 3.4 场地使用审核页

**功能点**:

- 空间管理员审核各主理人提交的场地使用申请

**权限**: 仅运营管理方 (空间管理员) 可用

**操作**:

- 通过
- 拒绝
- 审核意见

**相关接口**:

- 场地使用审核接口 (待补充)

### 4. 导航页

**功能点**:

- 提供各功能模块入口
- 显示用户信息
- 退出登录

**模块入口**:

- 活动排期管理
- 场地使用管理

## 通用功能

### 1. 基础数据获取

**空间区域列表**:

- 接口: `H5Api.Place.GetFieldList`
- 用途: 用于筛选和选择空间区域

**场地列表**:

- 接口: `H5Api.Place.GetPlaceList`
- 用途: 用于筛选和选择场地
- 支持按用途过滤 (活动排期/场地使用)

**服务类型列表**:

- 接口: `H5Api.Place.GetServiceTypeList`
- 用途: 用于选择活动的服务类型

### 2. 文件上传

**图片上传**:

- 支持格式: JPG, PNG, GIF 等
- 用途: 活动列表图、展示图、活动实录照片

**视频上传**:

- 用途: 活动实录视频

## 业务规则

### 1. 时间冲突检测

- 同一场地在同一时间段只能有一个活动或场地使用
- 提交时需要校验时间冲突

### 2. 权限控制

- 运营管理方：全部场地管理权限 + 审核权限
- 主理人：所负责场地的管理权限

### 3. 状态流转

**活动排期状态流转**:

```
待审核 → 待修改 (审核不通过)
待审核 → 按计划 (审核通过)
按计划 → 已完成 (活动结束)
按计划 → 已取消
按计划 → 已下架
```

**场地使用状态流转**:

```
待审核 → 已通过
待审核 → 已拒绝
```

**活动预约状态流转**:

```
待审核 → 已通过
待审核 → 已拒绝
已通过 → 已签到 (活动当天签到)
已通过 → 未参加 (活动结束未签到)
```

### 4. 数据格式

**日期时间格式**:

- 日期: `YYYY-MM-DD`
- 日期时间: `YYYY-MM-DD HH:mm:ss`
- 时间: `HH:mm:ss`

**分页参数**:

- `page`: 页数 (从 1 开始)
- `limit`: 每页行数

## 测试账号

| 用户名 | 密码     | 角色             |
| ------ | -------- | ---------------- |
| tljd   | 54231269 | 测试中心管理账号 |
| tlcsjg | 54231269 | 测试主理人账号   |

## 后台地址

- **测试环境**: http://smelapi.ieshanghai.cn

## 页面清单

1. ✅ 登录页
2. ✅ 导航页
3. 活动排期列表页
4. 活动排期详情页
5. 活动排期提交页
6. 活动预约详情页
7. 活动实录提交页
8. 场地使用列表页
9. 场地使用详情页
10. 场地使用提交页
11. 场地使用审核页

> ✅ 表示已完成，其他待开发
